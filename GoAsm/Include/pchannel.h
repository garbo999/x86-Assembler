#ifndef PCHANNEL_H
#define PCHANNEL_H

/* Virtual Channel protocol header */

#define CHANNEL_CHUNK_LENGTH  1600

#define CHANNEL_PDU_LENGTH  (CHANNEL_CHUNK_LENGTH + 8)

#define CHANNEL_FLAG_FIRST  0x01
#define CHANNEL_FLAG_LAST  0x02
#define CHANNEL_FLAG_ONLY  (CHANNEL_FLAG_FIRST|CHANNEL_FLAG_LAST)
#define CHANNEL_FLAG_MIDDLE  0
#define CHANNEL_FLAG_FAIL  0x100
#define CHANNEL_FLAG_SHOW_PROTOCOL  0x10
#define CHANNEL_FLAG_SUSPEND  0x20
#define CHANNEL_FLAG_RESUME  0x40

#define CHANNEL_OPTION_INITIALIZED  0x80000000
#define CHANNEL_OPTION_ENCRYPT_RDP  0x40000000
#define CHANNEL_OPTION_ENCRYPT_SC  0x20000000
#define CHANNEL_OPTION_ENCRYPT_CS  0x10000000
#define CHANNEL_OPTION_PRI_HIGH  0x08000000
#define CHANNEL_OPTION_PRI_MED  0x04000000
#define CHANNEL_OPTION_PRI_LOW  0x02000000
#define CHANNEL_OPTION_COMPRESS_RDP  0x00800000
#define CHANNEL_OPTION_COMPRESS  0x00400000
#define CHANNEL_OPTION_SHOW_PROTOCOL  0x00200000

#define CHANNEL_MAX_COUNT  30
#define CHANNEL_NAME_LEN  7

CHANNEL_DEF STRUCT
	name DB CHANNEL_NAME_LEN+1 DUP (?)
	options DD
ENDS

CHANNEL_PDU_HEADER STRUCT
	length DD
	flags DD
ENDS

#endif
